<!DOCTYPE html>
<html lang="ja" data-theme="light">
<head>
  <meta charset="UTF-8" />
  <title>数学 II・B 演習（LaTeX入力・即時プレビュー） - TestApp</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="description" content="数学 II・B（数列・ベクトルなど）入試基礎〜標準レベル。LaTeX で入力し、即時プレビューと正規化に基づく採点を行います。" />
  <!-- App styles (既存の共通CSSがある前提。無ければ削除しても可) -->
  <link rel="stylesheet" href="../assets/css/base.css">
  <link rel="stylesheet" href="../assets/css/layout.css">
  <link rel="stylesheet" href="../assets/css/components.css">
  <link rel="stylesheet" href="../assets/css/themes.css">
  <link rel="stylesheet" href="../assets/css/effects.css">

  <!-- KaTeX -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css">
  <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js"></script>

  <!-- 正規化（\ は1個の前提で KaTeX に渡す） -->
  <script defer src="../assets/js/answer-normalizer.js"></script>

  <!-- ページロジック -->
  <script defer src="../assets/js/math-2b.js"></script>

  <style>
    .qbox{border:1px solid var(--border-color,#d4dbe3);border-radius:14px;padding:.8rem 1rem;background:var(--layer-bg,#fff);}
    .qbox legend{padding:0 .4rem;font-size:.65rem;letter-spacing:.03em;}
    .qtext{font-size:.9rem;margin:.2rem 0 .6rem;display:flex;flex-direction:column;gap:.35rem;}
    .row{display:flex;flex-wrap:wrap;gap:.6rem;align-items:center;}
    .input-area{display:flex;flex-direction:column;gap:.35rem; width:100%; max-width:800px;}
    .input-area input[type="text"]{
      width:100%; padding:.6rem .7rem; font-size:.95rem;
      border:1.6px solid var(--border-color,#cbd5e1); border-radius:10px;
      font-family:ui-monospace,Menlo,Consolas,monospace;
    }
    .preview{font-size:1.2rem; min-height:1.8rem;}
    .norm{font-family:ui-monospace,Menlo,Consolas,monospace; font-size:.8rem; color:#334155; word-break:break-all;}
    .err{color:#b91c1c; font-size:.85rem;}
    .warn{color:#a16207; font-size:.8rem;}
    .kbd{display:flex;flex-wrap:wrap;gap:.35rem;}
    .kbd button{padding:.28rem .5rem; border:1px solid #cbd5e1; border-radius:8px; background:#fff; cursor:pointer; font-family:ui-monospace,Menlo,Consolas,monospace;}
    .badge{display:inline-block;background:#e2e8f0;color:#334155;font-size:.65rem;padding:.15rem .45rem;border-radius:10px;letter-spacing:.02em;}
    .meta{display:flex;gap:.6rem;align-items:center;flex-wrap:wrap;}
    .glass{background:var(--layer-bg,#fff);border:1px solid #e2e8f0;border-radius:12px;padding:.8rem 1rem;}
    .mode-tag{font-size:.7rem;color:#475569;}
    .controls{display:flex;gap:.5rem;flex-wrap:wrap;}
    .ok{color:#166534;}
    .ng{color:#b91c1c;}
    .rules{font-size:.85rem;color:#475569;}
    .rules a{color:#334155;text-decoration:underline dotted;}
    .hero{padding:.4rem 0;}
    .hero-title{margin:0 0 .25rem 0;}
    .hero-subtitle{margin:.1rem 0 .2rem 0;color:#475569;}
  </style>
</head>
<body>
  <a class="skip-link" href="#main">メインコンテンツへ移動</a>

  <header class="site-header" id="siteHeader">
    <div class="header-inner">
      <div class="brand">
        <img src="../assets/img/logo.svg" alt="TestApp ロゴ" class="logo" onerror="this.style.display='none'">
        <span class="brand-name">TestApp</span>
      </div>
      <nav class="primary-nav" aria-label="メインナビゲーション">
        <ul class="nav-list" id="navList">
          <li><a class="nav-link" href="../index.html#home">ホーム</a></li>
          <li><a class="nav-link" href="../index.html#subjects">科目</a></li>
          <li><a class="nav-link active" href="2b.html">数学 II・B</a></li>
          <li><a class="nav-link" href="../index.html#about">概要</a></li>
        </ul>
        <span class="nav-indicator" id="navIndicator" aria-hidden="true"></span>
      </nav>
      <div class="header-tools">
        <button class="theme-toggle" id="themeCycleBtn" aria-label="テーマ切替">
          <span class="theme-icon" data-theme-icon>🌞</span>
        </button>
      </div>
    </div>
  </header>

  <main id="main" class="main">
    <section class="hero" style="margin-top:1.2rem;">
      <div class="hero-content">
        <h1 class="hero-title">数学 II・B 演習（LaTeX 入力）</h1>
        <p class="hero-subtitle">
          LaTeX 記法で解答を 1 行入力し、即時にプレビュー・正規化します。採点は正規化後の文字列一致です。
        </p>
        <p class="rules">
          入力例: \frac{3^{n}-1}{2}, a_n=2^{n}-1, -\frac{2}{3}, \sqrt{17}（入力欄では「\」は1個）
        </p>
      </div>
    </section>

    <section class="section">
      <header class="section-head">
        <h2 class="section-title">設定</h2>
      </header>
      <div class="meta">
        <label style="font-size:.9rem;display:flex;flex-direction:column;gap:.25rem;">
          出題数
          <select id="countSel" style="padding:.35rem .5rem;font-size:.9rem;">
            <option value="3">3</option>
            <option value="5" selected>5</option>
            <option value="8">8</option>
            <option value="10">10</option>
            <option value="12">12</option>
          </select>
        </label>
        <label style="font-size:.9rem;display:flex;flex-direction:column;gap:.25rem;">
          難易度
          <select id="diffSel" style="padding:.35rem .5rem;font-size:.9rem;">
            <option value="">全て</option>
            <option value="1">1（基礎）</option>
            <option value="2" selected>2（標準）</option>
            <option value="3">3（やや難）</option>
          </select>
        </label>
        <div class="controls">
          <button id="loadBtn" class="btn" type="button">新セット生成</button>
          <button id="gradeBtn" class="btn" type="button">採点</button>
          <button id="mistakeBtn" class="btn" type="button" disabled>間違い復習</button>
          <button id="clearBtn" class="btn alt" type="button">クリア</button>
          <span id="testMeta" class="badge">-</span>
        </div>
      </div>
      <div class="glass" style="margin-top:.6rem;">
        <div style="font-size:.9rem;margin-bottom:.35rem;">サイト内キーボード（\ は1個）</div>
        <div class="kbd" id="globalKbd">
          <button data-ins="\frac{ }{ }">\frac{ }{ }</button>
          <button data-ins="\sqrt{ }">\sqrt{ }</button>
          <button data-ins="a_n">a_n</button>
          <button data-ins="S_n">S_n</button>
          <button data-ins="^{n}">^{n}</button>
          <button data-ins="_{n}">_{n}</button>
          <button data-ins="\binom{ }{ }">\binom{ }{ }</button>
          <button data-ins="\equiv">\equiv</button>
          <button data-ins="\pmod{ }">\pmod{ }</button>
          <button data-ins="\{  \}">\{  \}</button>
          <button data-ins="(">(</button>
          <button data-ins=")">)</button>
          <button data-ins="+">+</button>
          <button data-ins="-">-</button>
          <button data-ins=":">:</button>
          <button data-ins="=">=</button>
        </div>
      </div>
    </section>

    <section class="section">
      <header class="section-head">
        <h2 class="section-title">問題</h2>
      </header>
      <div id="questionContainer" style="display:flex;flex-direction:column;gap:.9rem;"></div>
      <div id="resultBox" style="margin-top:1rem;"></div>
    </section>
  </main>

  <!-- 既存の共通スクリプトがある場合のみ -->
  <script src="../assets/js/theme.js" defer></script>
  <script src="../assets/js/click-effect.js" defer></script>
</body>
</html>
