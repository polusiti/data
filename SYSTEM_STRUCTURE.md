# 問題管理システム構造図

## 🏗️ 全体アーキテクチャ

```
問題管理システム
├── 🔐 認証システム
│   ├── シングル管理者アカウント (sys/izumiya)
│   └── セッション管理
├── 💾 データストレージ
│   ├── IndexedDB (主)
│   └── localStorage (フォールバック)
├── 📱 PWAフレームワーク
│   ├── Service Worker
│   ├── マニフェストファイル
│   └── オフライン機能
└── 🎨 UIコンポーネント
    ├── モバイル最適化インターフェース
    ├── レスポンシブデザイン
    └── テーマシステム
```

## 📁 ファイル構成

### コアシステム
```
question-manager/
├── auth-simple.js              # 認証システム
├── database-fixed.js           # データベース管理
├── common.css                  # 共通スタイル
├── manifest.json               # PWAマニフェスト
└── sw.js                       # Service Worker
```

### メインアプリケーション
```
├── index.html                  # 質問管理メイン画面
├── dashboard.html              # 管理者ダッシュボード
├── enhanced-dashboard.html     # 拡張ダッシュボード
├── mobile-creator.html         # モバイル作成ツール
└── advanced-editor.html        # 高度なエディタ
```

### 拡張機能モジュール
```
├── 🤖 question-content-enhancer.js    # AI質問生成・自動解説
├── ✏️ rich-content-editor.js           # リッチコンテントエディタ
├── 📊 difficulty-analyzer.js          # 難易度分析システム
├── 📝 enhanced-question-types.js      # 拡張質問タイプ
├── 📤 data-exchange.js               # データ交換システム
├── 📈 enhanced-analytics.js          # 高度な分析機能
├── 📱 enhanced-mobile-creator.js     # 拡張モバイルクリエイター
└── 🎯 dashboard.js                   # ダッシュボード機能
```

### データファイル
```
data/
└── questions/
    ├── quiz-choice-questions.json    # 選択問題
    ├── quiz-f1-questions.json        # F1形式問題
    └── quiz-f2-questions.json        # F2形式問題
```

## 🔧 機能モジュール詳細

### 1. 質問作成システム
```
質問作成
├── 基本タイプ (A1-A3, F1-F2)
├── 拡張タイプ
│   ├── 画像選択問題
│   ├── 穴埋め問題
│   ├── 組み合わせ問題
│   ├── 順序付け問題
│   ├── 音声問題
│   └── 複数選択問題
└── テンプレートシステム
    ├── 数学4選
    ├── 英語4選
    ├── 理科4選
    ├── 国語4選
    ├── 記述式
    └── その他12種類
```

### 2. AI機能
```
AIパワード機能
├── 質問自動生成
│   ├── 数学問題生成
│   ├── 英語問題生成
│   └── 理科問題生成
├── 自動解説生成
│   ├── ステップバイステップ解説
│   ├── 教育的コンテキスト
│   └── 関連概念説明
└── 難易度分析
    ├── 認知需要評価
    ├── ブルーム分類法
    └── 学習時間推定
```

### 3. リッチエディタ
```
リッチコンテントエディタ
├── 基本フォーマット
│   ├── 見出し (H1-H6)
│   ├── 太字/斜体/下線
│   ├── 箇条書き/番号付きリスト
│   └── テキスト配置
├── 数式機能
│   ├── LaTeXサポート
│   ├── 数式テンプレート
│   └── MathJax統合
├── 挿入機能
│   ├── 画像
│   ├── テーブル
│   ├── リンク
│   └── 動画
└── 教育ブロック
    ├── 重要ポイント
    ├── 例題
    ├── 発展問題
    └── 学習ヒント
```

### 4. データ管理
```
データ交換システム
├── エクスポート形式
│   ├── JSON
│   ├── CSV
│   ├── Excel
│   ├── XML
│   ├── QTI 2.1
│   └── Moodle XML
├── インポート機能
│   ├── 形式自動検出
│   ├── データ検証
│   └── 重複チェック
└── バックアップ/復元
    ├── 自動バックアップ
    ├── バージョン管理
    └── 差分比較
```

### 5. 分析機能
```
分析システム
├── 基本統計
│   ├── 質問数
│   ├── アクティブユーザー
│   ├── 今日の作成数
│   └── 平均難易度
├── 高度な分析
│   ├── 使用状況分析
│   ├── 学習進捗
│   ├── 難易度分布
│   └── トレンド分析
└── レポート機能
    ├── カスタムレポート
    ├── データ可視化
    └── エクスポート機能
```

## 🔄 データフロー

```
ユーザー入力
    ↓
認証システム → 権限チェック
    ↓
メインアプリケーション
    ↓
機能モジュール選択
    ↓
├── 質問作成 → データベース保存
├── 編集機能 → リアルタイム更新
├── 分析機能 → 統計処理
└── エクスポート → ファイル生成
    ↓
UI表示/フィードバック
```

## 🎯 技術スタック

- **フロントエンド**: HTML5, CSS3, Vanilla JavaScript
- **データベース**: IndexedDB + localStorage
- **数式処理**: MathJax
- **PWA**: Service Worker, Web App Manifest
- **エクスポート**: SheetJS (Excel), custom formatters
- **UIフレームワーク**: カスタムCSSコンポーネント
- **アイコン**: Emoji + Unicode記号

## 🔒 セキュリティ機能

- シングル管理者認証
- セッションタイムアウト
- 入力データ検証
- XSS防止
- ログ記録

## 📱 PWA機能

- オフライン動作
- ホーム画面インストール
- プッシュ通知対応
- バックグラウンド同期
- キャッシュ管理

この構造により、教育機関での利用に適した、堅牢で機能豊富な問題管理システムが実現されています。