# リポジトリセキュリティ保護対策

## 実施済みの保護対策

### 1. Gitフックによる自動検知
- **pre-commitフック**: コミット前に不正な変更を検知・ブロック
- **pre-pushフック**: プッシュ前に追加のセキュリティチェックを実行

### 2. .gitignoreによる予防的ブロック
- 英語関連ファイルの自動無視設定
- サンプルデータファイルのブロック
- 機密設定ファイルの保護

### 3. 保護ルール
```bash
# ブロック対象:
- *english*, *English*, *lesson*, *Lesson*
- *learning*, *Learning*, vocab/, grammar/
- sample-*.json, test-data-*.json, mock-data-*.json
- physics/, chemistry/ の削除
```

## セキュリティチェック機能

### pre-commitフックのチェック項目
1. 英語関連ファイルの追加検知
2. 重要ファイル（physics/, chemistry/等）の削除検知
3. サンプルデータファイルの追加検知
4. 不審なコンテンツパターンの検知

### pre-pushフックのチェック項目
1. ブランチ名の検証（mainブランチのみ許可）
2. 強制プッシュのブロック
3. 物理・化学システムの存在確認
4. 過去コミットの不正変更検知

## 定期監視

### 毎日の確認事項
```bash
# 1. 重要ディレクトリの存在確認
ls -la physics/ chemistry/

# 2. 直近の変更確認
git log --oneline -5 --stat

# 3. ブロックされたファイルの確認
git status --ignored
```

### 週次の監査項目
1. コミット履歴のレビュー
2. 貢献者の確認
3. 不審な変更履歴の調査

## 緊急対応手順

### 不正な変更を発見した場合
1. **即時対応**:
   ```bash
   # 現在の変更を確認
   git status
   git diff

   # 不正な変更をリセット
   git reset --hard HEAD~1
   ```

2. **履歴のクリーンアップ**:
   ```bash
   # 不正なコミットを特定して削除
   git rebase -i <安全なコミットID>

   # リモートに強制反映
   git push --force-with-lease origin main
   ```

3. **原因調査**:
   - 誰が、いつ、どのような変更を行ったか
   - どのように保護対策を回避したか
   - 再発防止策の強化

## 技術的対策

### 保護レベルの設定
- **レベル1**: .gitignoreによる予防的ブロック
- **レベル2**: pre-commitフックによるコミット時検知
- **レベル3**: pre-pushフックによるプッシュ時検知
- **レベル4**: 手動監査と定期的レビュー

### 監視対象の拡張
今後監視を追加する可能性のあるパターン:
- 英語学習関連のファイル
- 語彙・文法データ
- TOEIC/IELTS等の試験コンテンツ

## 連絡先と報告

### セキュリティインシデント報告
- 不正な変更を発見した場合は直ちに報告
- Gitフックがブロックした場合はログを確認
- 定期的な監査結果を記録

### 保護対策の更新
- 新しい脅威パターンを発見した場合は随時更新
- Gitフックのルールを定期的に見直し
- .gitignoreのパターンを適宜調整

---
最終更新: 2024年10月6日
目的: 未承認のGit変更を完全に阻止するため