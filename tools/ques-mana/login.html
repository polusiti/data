<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>ログイン - 問題管理（新）</title>
  <link rel="manifest" href="manifest.webmanifest">
  <link rel="stylesheet" href="styles.css">
  <meta name="theme-color" content="#4f46e5">
  <script>
    if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
        navigator.serviceWorker.register('./sw.js').catch(console.error);
      });
    }
  </script>
</head>
<body class="centered">
  <form id="loginForm" class="card" style="max-width:420px; width:100%;">
    <h1 style="margin-bottom:16px;">ログイン</h1>
    <div class="form-group">
      <label>ユーザー名</label>
      <input id="username" autocomplete="username" placeholder="sys">
      <div id="usernameError" class="error-text"></div>
    </div>
    <div class="form-group">
      <label>パスワード</label>
      <input id="password" type="password" autocomplete="current-password" placeholder="izumiya">
      <div id="passwordError" class="error-text"></div>
    </div>
    <label class="checkbox">
      <input type="checkbox" id="remember">
      サインイン状態を保持する
    </label>
    <div id="alertMessage" class="alert" style="display:none;"></div>
    <button id="loginBtn" class="btn btn-primary" type="submit">
      <span class="btn-text">ログイン</span>
    </button>
  </form>

  <script src="js/auth.js"></script>
  <script>
    document.addEventListener('DOMContentLoaded', () => {
      if (AuthenticationSystem.getCurrentUser()) {
        location.replace('index.html');
        return;
      }
      document.getElementById('loginForm').addEventListener('submit', (e) => {
        e.preventDefault();
        window.auth?.handleLogin();
      });
    });
  </script>
</body>
</html>
