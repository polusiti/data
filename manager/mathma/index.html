<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>🔢 Math Manager - 数学問題管理システム</title>
    <style>
        :root {
            --primary-color: #3b82f6;
            --secondary-color: #1e40af;
            --accent-color: #60a5fa;
            --bg-color: #eff6ff;
            --text-color: #1f2937;
            --border-color: #bfdbfe;
            --hover-bg: #dbeafe;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Hiragino Sans', sans-serif;
            background-color: var(--bg-color);
            color: var(--text-color);
            line-height: 1.6;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 40px 20px;
        }

        .header {
            text-align: center;
            margin-bottom: 60px;
        }

        .header h1 {
            font-size: 3rem;
            color: var(--primary-color);
            margin-bottom: 20px;
        }

        .header p {
            font-size: 1.2rem;
            color: #6b7280;
        }

        .modules-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 30px;
            margin-bottom: 40px;
        }

        .module-card {
            background: white;
            border-radius: 16px;
            padding: 30px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
            transition: all 0.3s ease;
            text-decoration: none;
            color: inherit;
            display: block;
            cursor: pointer;
        }

        .module-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 30px rgba(0,0,0,0.15);
        }

        .module-icon {
            font-size: 3rem;
            margin-bottom: 20px;
        }

        .module-title {
            font-size: 1.5rem;
            font-weight: bold;
            margin-bottom: 15px;
        }

        .module-description {
            color: #6b7280;
            line-height: 1.6;
            margin-bottom: 20px;
        }

        .module-features {
            list-style: none;
        }

        .module-features li {
            padding: 5px 0;
            color: #6b7280;
            font-size: 0.9rem;
        }

        .module-features li:before {
            content: "✓ ";
            color: var(--primary-color);
            font-weight: bold;
        }

        /* モジュール別カラー */
        .math1 { --module-color: #3b82f6; }
        .math2 { --module-color: #10b981; }
        .math3 { --module-color: #f59e0b; }
        .mathA { --module-color: #8b5cf6; }
        .mathB { --module-color: #ef4444; }
        .creator { --module-color: #06b6d4; }
        .manager { --module-color: #6b7280; }

        .module-card.math1 .module-icon,
        .module-card.math1 .module-title { color: #3b82f6; }
        
        .module-card.math2 .module-icon,
        .module-card.math2 .module-title { color: #10b981; }
        
        .module-card.math3 .module-icon,
        .module-card.math3 .module-title { color: #f59e0b; }
        
        .module-card.mathA .module-icon,
        .module-card.mathA .module-title { color: #8b5cf6; }
        
        .module-card.mathB .module-icon,
        .module-card.mathB .module-title { color: #ef4444; }
        
        .module-card.creator .module-icon,
        .module-card.creator .module-title { color: #06b6d4; }
        
        .module-card.manager .module-icon,
        .module-card.manager .module-title { color: #6b7280; }

        .stats-section {
            background: white;
            border-radius: 16px;
            padding: 30px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
            margin-top: 40px;
        }

        .sample-section {
            background: white;
            border-radius: 16px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
            text-align: center;
        }

        .sample-content h3 {
            color: var(--primary-color);
            margin-bottom: 15px;
        }

        .btn-sample {
            background: var(--primary-color);
            color: white;
            border: none;
            padding: 12px 30px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1rem;
            font-weight: 500;
            margin: 15px 10px;
            transition: all 0.3s ease;
        }

        .btn-sample:hover {
            background: var(--secondary-color);
            transform: translateY(-2px);
        }

        .btn-secondary {
            background: #6b7280;
        }

        .btn-secondary:hover {
            background: #4b5563;
        }

        .sample-message {
            margin-top: 15px;
            padding: 10px;
            border-radius: 6px;
            font-size: 0.9rem;
            display: none;
        }

        .sample-message.success {
            background: #dbeafe;
            color: #1e40af;
            border: 1px solid #bfdbfe;
            display: block;
        }

        .sample-message.error {
            background: #fee2e2;
            color: #991b1b;
            border: 1px solid #fecaca;
            display: block;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 30px;
        }

        .stat-item {
            text-align: center;
        }

        .stat-number {
            font-size: 2.5rem;
            font-weight: bold;
            color: var(--primary-color);
        }

        .stat-label {
            color: #6b7280;
            margin-top: 5px;
        }

        .footer {
            text-align: center;
            margin-top: 60px;
            color: #6b7280;
        }

        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            background: var(--primary-color);
            color: white;
            padding: 15px 25px;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            z-index: 1000;
            animation: slideIn 0.3s ease;
        }

        @keyframes slideIn {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }

        /* PWA準備 */
        .pwa-info {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
            padding: 20px;
            border-radius: 12px;
            margin-bottom: 30px;
            text-align: center;
        }

        .pwa-info h3 {
            margin-bottom: 10px;
        }

        @media (max-width: 768px) {
            .header h1 {
                font-size: 2rem;
            }
            
            .modules-grid {
                grid-template-columns: 1fr;
            }
            
            .stats-grid {
                grid-template-columns: repeat(2, 1fr);
            }

            .btn-sample {
                display: block;
                margin: 10px 0;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>🔢 Math Manager</h1>
            <p>数学問題管理システム - A1択・F1自由・F2記述対応</p>
        </div>

        <div class="pwa-info">
            <h3>📱 スマホ対応・PWA Ready</h3>
            <p>モバイルファーストデザイン | 協働問題作成 | 評価システム</p>
        </div>

        <div class="modules-grid">
            <a href="math1/" class="module-card math1">
                <div class="module-icon">📐</div>
                <h2 class="module-title">数学I</h2>
                <p class="module-description">基礎数学の問題作成・管理システム</p>
                <ul class="module-features">
                    <li>数と式（因数分解・絶対値）</li>
                    <li>集合と論理（命題・証明）</li>
                    <li>二次関数（グラフ・最値）</li>
                    <li>図形と計量（三角比）</li>
                    <li>データの分析（統計）</li>
                </ul>
            </a>

            <a href="math2/" class="module-card math2">
                <div class="module-icon">📊</div>
                <h2 class="module-title">数学II</h2>
                <p class="module-description">発展数学の問題作成・管理システム</p>
                <ul class="module-features">
                    <li>式と証明（恒等式・不等式）</li>
                    <li>複素数と方程式</li>
                    <li>図形と方程式（軌跡・領域）</li>
                    <li>三角関数（加法定理）</li>
                    <li>指数・対数関数</li>
                </ul>
            </a>

            <a href="math3/" class="module-card math3">
                <div class="module-icon">∫</div>
                <h2 class="module-title">数学III</h2>
                <p class="module-description">高度数学の問題作成・管理システム</p>
                <ul class="module-features">
                    <li>極限（数列・関数の極限）</li>
                    <li>微分法（導関数・応用）</li>
                    <li>積分法（定積分・応用）</li>
                    <li>複素数平面</li>
                    <li>二次曲線</li>
                </ul>
            </a>

            <a href="mathA/" class="module-card mathA">
                <div class="module-icon">🎲</div>
                <h2 class="module-title">数学A</h2>
                <p class="module-description">場合の数・確率・図形の問題管理</p>
                <ul class="module-features">
                    <li>場合の数と確率</li>
                    <li>図形の性質（平面・空間）</li>
                    <li>整数の性質（約数・倍数）</li>
                    <li>A1択・F1記述対応</li>
                </ul>
            </a>

            <a href="mathB/" class="module-card mathB">
                <div class="module-icon">📈</div>
                <h2 class="module-title">数学B</h2>
                <p class="module-description">数列・ベクトル・統計の問題管理</p>
                <ul class="module-features">
                    <li>数列（等差・等比・漸化式）</li>
                    <li>ベクトル（平面・空間）</li>
                    <li>統計的な推測</li>
                    <li>複合問題対応</li>
                </ul>
            </a>

            <a href="creator/" class="module-card creator">
                <div class="module-icon">✨</div>
                <h2 class="module-title">問題作成</h2>
                <p class="module-description">協働問題作成システム</p>
                <ul class="module-features">
                    <li>A1択・F1自由・F2記述</li>
                    <li>LaTeX数式対応</li>
                    <li>3人承認システム</li>
                    <li>評価・コメント機能</li>
                </ul>
            </a>

            <a href="manager/" class="module-card manager">
                <div class="module-icon">📋</div>
                <h2 class="module-title">問題管理</h2>
                <p class="module-description">総合問題管理・統計システム</p>
                <ul class="module-features">
                    <li>全問題一覧・検索</li>
                    <li>正答率・評価統計</li>
                    <li>D1データ管理</li>
                    <li>エクスポート制限</li>
                </ul>
            </a>

            <a href="practice/" class="module-card" style="--module-color: #ec4899;">
                <div class="module-icon" style="color: #ec4899;">🎯</div>
                <h2 class="module-title" style="color: #ec4899;">問題練習</h2>
                <p class="module-description">実際に数学問題を解いて学習体験</p>
                <ul class="module-features">
                    <li>全分野対応練習</li>
                    <li>難易度別出題</li>
                    <li>即時採点・解説</li>
                    <li>学習進捗管理</li>
                </ul>
            </a>
        </div>

        <div class="stats-section">
            <h3 style="text-align: center; margin-bottom: 30px; color: var(--primary-color);">📊 システム概要</h3>
            <div class="stats-grid">
                <div class="stat-item">
                    <div class="stat-number" id="totalQuestions">0</div>
                    <div class="stat-label">総問題数</div>
                </div>
                <div class="stat-item">
                    <div class="stat-number" id="totalModules">5</div>
                    <div class="stat-label">数学分野</div>
                </div>
                <div class="stat-item">
                    <div class="stat-number" id="totalFormats">3</div>
                    <div class="stat-label">問題形式</div>
                </div>
                <div class="stat-item">
                    <div class="stat-number" id="localStorage">D1</div>
                    <div class="stat-label">データ管理</div>
                </div>
                <div class="stat-item">
                    <div class="stat-number" id="approvalSystem">3+</div>
                    <div class="stat-label">承認システム</div>
                </div>
                <div class="stat-item">
                    <div class="stat-number" id="pwReady">✓</div>
                    <div class="stat-label">PWA対応</div>
                </div>
            </div>
        </div>

        <div class="sample-section">
            <div class="sample-content">
                <h3>🎲 サンプルデータ管理</h3>
                <p>数学問題のサンプルデータを読み込んで、システムを体験できます。</p>
                <div>
                    <button class="btn-sample" onclick="loadSampleData()">📥 サンプルデータ読み込み</button>
                    <button class="btn-sample btn-secondary" onclick="clearAllData()">🗑️ 全データクリア</button>
                    <button class="btn-sample" onclick="exportData()">📤 データエクスポート</button>
                </div>
                <div id="sample-message" class="sample-message"></div>
            </div>
        </div>

        <div class="footer">
            <p>&copy; 2024 Math Manager - 数学問題管理システム. PWA Ready.</p>
        </div>
    </div>

    <script>
        // 数学問題管理システムクラス
        class MathManager {
            constructor() {
                this.modules = ['math1', 'math2', 'math3', 'mathA', 'mathB'];
                this.init();
            }

            init() {
                this.updateStats();
                this.showWelcomeMessage();
            }

            // 統計情報の更新
            updateStats() {
                let totalQuestions = 0;
                
                this.modules.forEach(module => {
                    const questions = JSON.parse(localStorage.getItem(module + 'Questions') || '[]');
                    totalQuestions += questions.length;
                });
                
                document.getElementById('totalQuestions').textContent = totalQuestions;
            }

            // 通知表示
            showNotification(message, duration = 3000) {
                const notification = document.createElement('div');
                notification.className = 'notification';
                notification.textContent = message;
                document.body.appendChild(notification);

                setTimeout(() => {
                    notification.remove();
                }, duration);
            }

            // ウェルカムメッセージ
            showWelcomeMessage() {
                setTimeout(() => {
                    this.showNotification('🔢 Math Manager へようこそ！');
                }, 1000);
            }

            // メッセージ表示
            showMessage(message, type) {
                const messageElement = document.getElementById('sample-message');
                messageElement.textContent = message;
                messageElement.className = `sample-message ${type}`;
            }
        }

        // サンプルデータ読み込み関数
        function loadSampleData() {
            try {
                const sampleData = {
                    math1Questions: [
                        {
                            id: 'math1_001',
                            type: 'A1',
                            title: '二次関数の最大値',
                            question: 'f(x) = -x² + 4x + 1 の最大値は？',
                            choices: ['3', '4', '5', '6'],
                            correct: 2,
                            difficulty: 'B',
                            field: '二次関数',
                            explanation: 'f(x) = -(x-2)² + 5 より、最大値は5',
                            created: new Date().toISOString(),
                            approvals: 3,
                            rating: 4.2
                        },
                        {
                            id: 'math1_002',
                            type: 'F1',
                            title: '絶対値方程式',
                            question: '|2x - 3| = 5 を満たすxの値をすべて求めよ。',
                            answer: 'x = 4, -1',
                            difficulty: 'A',
                            field: '数と式',
                            explanation: '2x-3=5 または 2x-3=-5 を解く',
                            created: new Date().toISOString(),
                            approvals: 3,
                            rating: 3.8
                        }
                    ],
                    mathAQuestions: [
                        {
                            id: 'mathA_001',
                            type: 'A1',
                            title: '確率の基本',
                            question: 'サイコロを2回投げて、和が7になる確率は？',
                            choices: ['1/6', '1/5', '1/4', '1/3'],
                            correct: 0,
                            difficulty: 'A',
                            field: '場合の数と確率',
                            explanation: '(1,6),(2,5),(3,4),(4,3),(5,2),(6,1)の6通り / 36通り = 1/6',
                            created: new Date().toISOString(),
                            approvals: 4,
                            rating: 4.5
                        }
                    ],
                    math3Questions: [
                        {
                            id: 'math3_001',
                            type: 'F2',
                            title: '定積分の計算',
                            question: '∫[0→1] x²dx を計算せよ。',
                            answer: '1/3',
                            difficulty: 'B',
                            field: '積分法',
                            explanation: '[x³/3]₀¹ = 1/3 - 0 = 1/3',
                            created: new Date().toISOString(),
                            approvals: 5,
                            rating: 4.0
                        }
                    ]
                };

                // データを保存
                Object.keys(sampleData).forEach(key => {
                    localStorage.setItem(key, JSON.stringify(sampleData[key]));
                });

                window.mathManager.updateStats();
                window.mathManager.showMessage(
                    '✅ サンプルデータを読み込みました！数学I: 2問、数学A: 1問、数学III: 1問',
                    'success'
                );
                window.mathManager.showNotification('📊 サンプルデータ読み込み完了');

            } catch (error) {
                window.mathManager.showMessage('❌ サンプルデータの読み込みに失敗しました。', 'error');
            }
        }

        // 全データクリア
        function clearAllData() {
            if (confirm('すべての問題データを削除してもよろしいですか？\nこの操作は取り消せません。')) {
                const modules = ['math1', 'math2', 'math3', 'mathA', 'mathB'];
                modules.forEach(module => {
                    localStorage.removeItem(module + 'Questions');
                });
                
                window.mathManager.updateStats();
                window.mathManager.showMessage('🗑️ すべてのデータを削除しました。', 'success');
                window.mathManager.showNotification('データクリア完了');
            }
        }

        // データエクスポート（制限付き）
        function exportData() {
            try {
                const allData = {};
                const modules = ['math1', 'math2', 'math3', 'mathA', 'mathB'];
                
                modules.forEach(module => {
                    const questions = JSON.parse(localStorage.getItem(module + 'Questions') || '[]');
                    if (questions.length > 0) {
                        // データ制限（個人情報削除、承認済みのみ）
                        allData[module] = questions
                            .filter(q => q.approvals >= 3)
                            .map(q => ({
                                id: q.id,
                                type: q.type,
                                title: q.title,
                                question: q.question,
                                difficulty: q.difficulty,
                                field: q.field,
                                rating: q.rating
                            }));
                    }
                });

                const exportData = {
                    exported: new Date().toISOString(),
                    version: '1.0',
                    restriction: 'educational_use_only',
                    data: allData
                };

                const blob = new Blob([JSON.stringify(exportData, null, 2)], {
                    type: 'application/json'
                });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = `math-questions-${new Date().toISOString().split('T')[0]}.json`;
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                URL.revokeObjectURL(url);

                window.mathManager.showMessage('📤 承認済みデータをエクスポートしました（教育利用限定）', 'success');

            } catch (error) {
                window.mathManager.showMessage('❌ エクスポートに失敗しました。', 'error');
            }
        }

        // アプリケーション初期化
        document.addEventListener('DOMContentLoaded', function() {
            window.mathManager = new MathManager();
        });
    </script>
</body>
</html>