<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>🔢 Math Manager - シンプル統一版</title>
    <style>
        :root {
            --primary-color: #3b82f6;
            --secondary-color: #1e40af;
            --accent-color: #60a5fa;
            --bg-color: #eff6ff;
            --text-color: #1f2937;
            --border-color: #bfdbfe;
            --hover-bg: #dbeafe;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Hiragino Sans', sans-serif;
            background-color: var(--bg-color);
            color: var(--text-color);
            line-height: 1.6;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 40px 20px;
        }

        .header {
            text-align: center;
            margin-bottom: 60px;
        }

        .header h1 {
            font-size: 3rem;
            color: var(--primary-color);
            margin-bottom: 20px;
        }

        .header p {
            font-size: 1.2rem;
            color: #6b7280;
        }

        .modules-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 30px;
            margin-bottom: 40px;
        }

        .module-card {
            background: white;
            border-radius: 16px;
            padding: 30px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
            transition: all 0.3s ease;
            text-decoration: none;
            color: inherit;
            display: block;
            cursor: pointer;
        }

        .module-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 30px rgba(0,0,0,0.15);
        }

        .module-icon {
            font-size: 3rem;
            margin-bottom: 20px;
        }

        .module-title {
            font-size: 1.5rem;
            font-weight: bold;
            margin-bottom: 15px;
        }

        .module-description {
            color: #6b7280;
            line-height: 1.6;
            margin-bottom: 20px;
        }

        .module-features {
            list-style: none;
        }

        .module-features li {
            padding: 5px 0;
            color: #6b7280;
            font-size: 0.9rem;
        }

        .module-features li:before {
            content: "✓ ";
            color: var(--primary-color);
            font-weight: bold;
        }

        /* シンプル統一カラー */
        .math .module-icon,
        .math .module-title { color: #3b82f6; }
        
        .creator .module-icon,
        .creator .module-title { color: #10b981; }
        
        .manager .module-icon,
        .manager .module-title { color: #f59e0b; }
        
        .practice .module-icon,
        .practice .module-title { color: #ec4899; }

        .stats-section {
            background: white;
            border-radius: 16px;
            padding: 30px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
            margin-top: 40px;
        }

        .sample-section {
            background: white;
            border-radius: 16px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
            text-align: center;
        }

        .sample-content h3 {
            color: var(--primary-color);
            margin-bottom: 15px;
        }

        .btn-sample {
            background: var(--primary-color);
            color: white;
            border: none;
            padding: 12px 30px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1rem;
            font-weight: 500;
            margin: 15px 10px;
            transition: all 0.3s ease;
        }

        .btn-sample:hover {
            background: var(--secondary-color);
            transform: translateY(-2px);
        }

        .btn-secondary {
            background: #6b7280;
        }

        .btn-secondary:hover {
            background: #4b5563;
        }

        .sample-message {
            margin-top: 15px;
            padding: 10px;
            border-radius: 6px;
            font-size: 0.9rem;
            display: none;
        }

        .sample-message.success {
            background: #dbeafe;
            color: #1e40af;
            border: 1px solid #bfdbfe;
            display: block;
        }

        .sample-message.error {
            background: #fee2e2;
            color: #991b1b;
            border: 1px solid #fecaca;
            display: block;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 30px;
        }

        .stat-item {
            text-align: center;
        }

        .stat-number {
            font-size: 2.5rem;
            font-weight: bold;
            color: var(--primary-color);
        }

        .stat-label {
            color: #6b7280;
            margin-top: 5px;
        }

        .footer {
            text-align: center;
            margin-top: 60px;
            color: #6b7280;
        }

        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            background: var(--primary-color);
            color: white;
            padding: 15px 25px;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            z-index: 1000;
            animation: slideIn 0.3s ease;
        }

        @keyframes slideIn {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }

        /* PWA準備 */
        .pwa-info {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
            padding: 20px;
            border-radius: 12px;
            margin-bottom: 30px;
            text-align: center;
        }

        .pwa-info h3 {
            margin-bottom: 10px;
        }

        @media (max-width: 768px) {
            .header h1 {
                font-size: 2rem;
            }
            
            .modules-grid {
                grid-template-columns: 1fr;
            }
            
            .stats-grid {
                grid-template-columns: repeat(2, 1fr);
            }

            .btn-sample {
                display: block;
                margin: 10px 0;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>🔢 Math Manager</h1>
            <p>数学問題管理システム - シンプル統一方式</p>
        </div>

        <div class="pwa-info">
            <h3>📱 シンプル・統一・効率的</h3>
            <p>複雑な分野分けなし | A1択・F1自由・F2記述 | 協働問題作成</p>
            <div style="margin-top: 15px; font-size: 0.9rem; opacity: 0.9;">
                <strong>新機能:</strong> 詳細な問題管理・作成・練習システム完備 🚀
            </div>
        </div>

        <div class="modules-grid">
            <a href="math/" class="module-card math">
                <div class="module-icon">📐</div>
                <h2 class="module-title">数学問題</h2>
                <p class="module-description">すべての数学問題を統一して管理する単一システム</p>
                <ul class="module-features">
                    <li>高度なフィルタリング・検索機能</li>
                    <li>リアルタイム統計ダッシュボード</li>
                    <li>問題カード表示（ステータス・評価）</li>
                    <li>承認状況・進捗の可視化</li>
                    <li>カテゴリ別・難易度別表示</li>
                </ul>
            </a>

            <a href="creator/" class="module-card creator">
                <div class="module-icon">✨</div>
                <h2 class="module-title">問題作成</h2>
                <p class="module-description">協働問題作成システム - 簡潔で効率的</p>
                <ul class="module-features">
                    <li>動的フォーム（形式別UI切り替え）</li>
                    <li>リアルタイムプレビュー・検証</li>
                    <li>下書き保存・復元機能</li>
                    <li>選択肢エディタ（A1択対応）</li>
                    <li>協働作成・承認ワークフロー</li>
                </ul>
            </a>

            <a href="manager/" class="module-card manager">
                <div class="module-icon">📋</div>
                <h2 class="module-title">問題管理</h2>
                <p class="module-description">統合問題管理・統計システム</p>
                <ul class="module-features">
                    <li>管理者ダッシュボード・統計</li>
                    <li>一括承認・却下機能</li>
                    <li>タブ式ステータス管理</li>
                    <li>承認ワークフロー可視化</li>
                    <li>品質管理・データエクスポート</li>
                </ul>
            </a>

            <a href="practice/" class="module-card practice">
                <div class="module-icon">🎯</div>
                <h2 class="module-title">問題練習</h2>
                <p class="module-description">実際に数学問題を解いて学習体験</p>
                <ul class="module-features">
                    <li>4つの練習モード（ランダム・難易度・分野・時間制限）</li>
                    <li>インタラクティブな問題解答</li>
                    <li>学習統計・ストリーク追跡</li>
                    <li>結果分析・フィードバック</li>
                    <li>試験対策・タイマー機能</li>
                </ul>
            </a>
        </div>

        <div class="stats-section">
            <h3 style="text-align: center; margin-bottom: 30px; color: var(--primary-color);">📊 システム概要</h3>
            <div class="stats-grid">
                <div class="stat-item">
                    <div class="stat-number" id="totalQuestions">0</div>
                    <div class="stat-label">総問題数</div>
                </div>
                <div class="stat-item">
                    <div class="stat-number" id="approvedQuestions">0</div>
                    <div class="stat-label">承認済み</div>
                </div>
                <div class="stat-item">
                    <div class="stat-number" id="categoriesCount">0</div>
                    <div class="stat-label">カテゴリ数</div>
                </div>
                <div class="stat-item">
                    <div class="stat-number">3</div>
                    <div class="stat-label">問題形式</div>
                </div>
                <div class="stat-item">
                    <div class="stat-number">3+</div>
                    <div class="stat-label">承認システム</div>
                </div>
                <div class="stat-item">
                    <div class="stat-number">✓</div>
                    <div class="stat-label">PWA対応</div>
                </div>
            </div>
        </div>

        <div class="sample-section">
            <div class="sample-content">
                <h3>🎲 サンプル数学問題</h3>
                <p>様々な数学領域のサンプル問題を読み込んで、統一システムを体験できます。</p>
                <div>
                    <button class="btn-sample" onclick="loadSampleData()">📥 サンプル問題読み込み</button>
                    <button class="btn-sample btn-secondary" onclick="clearAllData()">🗑️ 全問題削除</button>
                    <button class="btn-sample" onclick="exportData()">📤 問題エクスポート</button>
                </div>
                <div id="sample-message" class="sample-message"></div>
            </div>
        </div>

        <div class="sample-section">
            <div class="sample-content">
                <h3>🚀 システム機能</h3>
                <p>完全統合された数学問題管理システムの各機能をご利用いただけます。</p>
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 10px; margin-top: 15px;">
                    <a href="math/" class="btn-sample" style="text-decoration: none;">📐 問題閲覧</a>
                    <a href="creator/" class="btn-sample" style="text-decoration: none;">✨ 問題作成</a>
                    <a href="manager/" class="btn-sample" style="text-decoration: none;">📋 問題管理</a>
                    <a href="practice/" class="btn-sample" style="text-decoration: none;">🎯 問題練習</a>
                </div>
            </div>
        </div>

        <div class="footer">
            <p>&copy; 2024 Math Manager - シンプル統一数学問題管理システム. PWA Ready.</p>
        </div>
    </div>

    <script>
        // シンプル数学問題管理システムクラス
        class SimpleMathManager {
            constructor() {
                this.init();
            }

            init() {
                this.updateStats();
                this.showWelcomeMessage();
            }

            // 統計情報の更新
            updateStats() {
                const questions = JSON.parse(localStorage.getItem('mathQuestions') || '[]');
                const approved = questions.filter(q => (q.approvals || 0) >= 3).length;
                const categories = [...new Set(questions.map(q => q.category).filter(Boolean))].length;
                
                document.getElementById('totalQuestions').textContent = questions.length;
                document.getElementById('approvedQuestions').textContent = approved;
                document.getElementById('categoriesCount').textContent = categories;
            }

            // 通知表示
            showNotification(message, duration = 3000) {
                const notification = document.createElement('div');
                notification.className = 'notification';
                notification.textContent = message;
                document.body.appendChild(notification);

                setTimeout(() => {
                    notification.remove();
                }, duration);
            }

            // ウェルカムメッセージ
            showWelcomeMessage() {
                setTimeout(() => {
                    this.showNotification('🔢 シンプル Math Manager へようこそ！');
                }, 1000);
            }

            // メッセージ表示
            showMessage(message, type) {
                const messageElement = document.getElementById('sample-message');
                messageElement.textContent = message;
                messageElement.className = `sample-message ${type}`;
            }
        }

        // サンプルデータ読み込み関数
        function loadSampleData() {
            try {
                const sampleData = [
                    {
                        id: 'math_001',
                        type: 'A1',
                        title: '二次方程式の解',
                        question: 'x² - 5x + 6 = 0 の解は？',
                        choices: ['x = 1, 6', 'x = 2, 3', 'x = -2, -3', 'x = -1, -6'],
                        correct: 1,
                        difficulty: '中',
                        category: '代数',
                        explanation: '因数分解すると (x-2)(x-3) = 0 より x = 2, 3',
                        created: new Date().toISOString(),
                        approvals: 3,
                        rating: 4.2
                    },
                    {
                        id: 'math_002',
                        type: 'F1',
                        title: '三角関数の値',
                        question: 'sin 60° の値を求めなさい。',
                        answer: '√3/2',
                        difficulty: '易',
                        category: '三角関数',
                        explanation: '特別角の値として覚える基本値',
                        created: new Date().toISOString(),
                        approvals: 4,
                        rating: 4.0
                    },
                    {
                        id: 'math_003',
                        type: 'F2',
                        title: '極限の計算',
                        question: 'lim(x→0) sin x / x を求めよ。',
                        answer: '1',
                        difficulty: '難',
                        category: '微分',
                        explanation: 'ロピタルの定理を使用するか、標準的な極限として知られている値',
                        created: new Date().toISOString(),
                        approvals: 5,
                        rating: 3.8
                    },
                    {
                        id: 'math_004',
                        type: 'A1',
                        title: '確率の基本',
                        question: 'コインを3回投げて、すべて表が出る確率は？',
                        choices: ['1/2', '1/4', '1/8', '1/16'],
                        correct: 2,
                        difficulty: '易',
                        category: '確率',
                        explanation: '(1/2)³ = 1/8',
                        created: new Date().toISOString(),
                        approvals: 3,
                        rating: 4.5
                    },
                    {
                        id: 'math_005',
                        type: 'F1',
                        title: '微分の計算',
                        question: 'f(x) = x³ + 2x² - x + 1 の導関数を求めなさい。',
                        answer: 'f\'(x) = 3x² + 4x - 1',
                        difficulty: '中',
                        category: '微分',
                        explanation: '各項をべき乗の公式で微分する',
                        created: new Date().toISOString(),
                        approvals: 4,
                        rating: 4.1
                    }
                ];

                // データを保存
                localStorage.setItem('mathQuestions', JSON.stringify(sampleData));

                window.mathManager.updateStats();
                window.mathManager.showMessage(
                    '✅ サンプル数学問題を読み込みました！代数・三角関数・微分・確率 合計5問',
                    'success'
                );
                window.mathManager.showNotification('📊 サンプルデータ読み込み完了');

            } catch (error) {
                window.mathManager.showMessage('❌ サンプルデータの読み込みに失敗しました。', 'error');
            }
        }

        // 全データクリア
        function clearAllData() {
            if (confirm('すべての数学問題を削除してもよろしいですか？\nこの操作は取り消せません。')) {
                localStorage.removeItem('mathQuestions');
                
                window.mathManager.updateStats();
                window.mathManager.showMessage('🗑️ すべての問題を削除しました。', 'success');
                window.mathManager.showNotification('問題データクリア完了');
            }
        }

        // データエクスポート（制限付き）
        function exportData() {
            try {
                const questions = JSON.parse(localStorage.getItem('mathQuestions') || '[]');
                
                if (questions.length === 0) {
                    window.mathManager.showMessage('📝 エクスポートする問題がありません。', 'error');
                    return;
                }

                // 承認済み問題のみ、個人情報削除
                const approvedQuestions = questions
                    .filter(q => q.approvals >= 3)
                    .map(q => ({
                        id: q.id,
                        type: q.type,
                        title: q.title,
                        question: q.question,
                        difficulty: q.difficulty,
                        category: q.category,
                        rating: q.rating
                    }));

                const exportData = {
                    exported: new Date().toISOString(),
                    version: '1.0-simple',
                    system: 'unified_math',
                    restriction: 'educational_use_only',
                    total: approvedQuestions.length,
                    questions: approvedQuestions
                };

                const blob = new Blob([JSON.stringify(exportData, null, 2)], {
                    type: 'application/json'
                });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = `simple-math-questions-${new Date().toISOString().split('T')[0]}.json`;
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                URL.revokeObjectURL(url);

                window.mathManager.showMessage(
                    `📤 承認済み問題${approvedQuestions.length}問をエクスポートしました（教育利用限定）`, 
                    'success'
                );

            } catch (error) {
                window.mathManager.showMessage('❌ エクスポートに失敗しました。', 'error');
            }
        }

        // アプリケーション初期化
        document.addEventListener('DOMContentLoaded', function() {
            window.mathManager = new SimpleMathManager();
        });
    </script>
</body>
</html>