<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üìê Êï∞Â≠¶ÂïèÈ°å - „Ç∑„É≥„Éó„É´Áµ±‰∏ÄÁÆ°ÁêÜ</title>
    <style>
        :root {
            --primary-color: #3b82f6;
            --secondary-color: #1e40af;
            --accent-color: #60a5fa;
            --bg-color: #eff6ff;
            --text-color: #1f2937;
            --border-color: #bfdbfe;
            --hover-bg: #dbeafe;
            --success-color: #10b981;
            --warning-color: #f59e0b;
            --error-color: #ef4444;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Hiragino Sans', sans-serif;
            background-color: var(--bg-color);
            color: var(--text-color);
            line-height: 1.6;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            background: white;
            border-radius: 12px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
            text-align: center;
        }

        .header h1 {
            font-size: 2.5rem;
            color: var(--primary-color);
            margin-bottom: 10px;
        }

        .header p {
            color: #6b7280;
            font-size: 1.1rem;
        }

        .nav-breadcrumb {
            background: white;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
        }

        .nav-breadcrumb a {
            color: var(--primary-color);
            text-decoration: none;
            margin-right: 10px;
        }

        .nav-breadcrumb a:hover {
            text-decoration: underline;
        }

        .controls-section {
            background: white;
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
        }

        .controls-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }

        .control-group {
            display: flex;
            flex-direction: column;
        }

        .control-group label {
            font-weight: 600;
            margin-bottom: 5px;
            color: var(--text-color);
        }

        .control-group select,
        .control-group input {
            padding: 10px;
            border: 2px solid var(--border-color);
            border-radius: 6px;
            font-size: 1rem;
            transition: border-color 0.3s;
        }

        .control-group select:focus,
        .control-group input:focus {
            outline: none;
            border-color: var(--primary-color);
        }

        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
            display: inline-block;
            text-align: center;
        }

        .btn-primary {
            background: var(--primary-color);
            color: white;
        }

        .btn-primary:hover {
            background: var(--secondary-color);
            transform: translateY(-2px);
        }

        .btn-secondary {
            background: #6b7280;
            color: white;
        }

        .btn-secondary:hover {
            background: #4b5563;
        }

        .btn-success {
            background: var(--success-color);
            color: white;
        }

        .btn-warning {
            background: var(--warning-color);
            color: white;
        }

        .btn-error {
            background: var(--error-color);
            color: white;
        }

        .questions-section {
            background: white;
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
        }

        .questions-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid var(--border-color);
        }

        .questions-list {
            min-height: 300px;
        }

        .question-card {
            border: 2px solid var(--border-color);
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 15px;
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .question-card:hover {
            border-color: var(--primary-color);
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }

        .question-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }

        .question-meta {
            display: flex;
            gap: 15px;
            font-size: 0.9rem;
            color: #6b7280;
        }

        .question-title {
            font-size: 1.2rem;
            font-weight: 700;
            color: var(--primary-color);
            margin-bottom: 10px;
        }

        .question-content {
            font-size: 1rem;
            margin-bottom: 15px;
            line-height: 1.6;
        }

        .question-tags {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        .tag {
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 600;
        }

        .tag-type {
            background: var(--primary-color);
            color: white;
        }

        .tag-difficulty {
            background: var(--success-color);
            color: white;
        }

        .tag-difficulty.medium {
            background: var(--warning-color);
        }

        .tag-difficulty.hard {
            background: var(--error-color);
        }

        .tag-category {
            background: #8b5cf6;
            color: white;
        }

        .tag-approval {
            background: #10b981;
            color: white;
        }

        .empty-state {
            text-align: center;
            padding: 60px 20px;
            color: #6b7280;
        }

        .empty-state-icon {
            font-size: 4rem;
            margin-bottom: 20px;
        }

        .stats-bar {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
            padding: 20px;
            border-radius: 12px;
            margin-bottom: 20px;
            text-align: center;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 20px;
            margin-top: 15px;
        }

        .stat-item h3 {
            font-size: 2rem;
            margin-bottom: 5px;
        }

        .stat-item p {
            font-size: 0.9rem;
            opacity: 0.9;
        }

        @media (max-width: 768px) {
            .header h1 {
                font-size: 2rem;
            }
            
            .controls-grid {
                grid-template-columns: 1fr;
            }
            
            .questions-header {
                flex-direction: column;
                align-items: stretch;
                gap: 15px;
            }
            
            .question-header {
                flex-direction: column;
                align-items: stretch;
                gap: 10px;
            }
            
            .question-meta {
                flex-wrap: wrap;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="nav-breadcrumb">
            <a href="../">üî¢ Math Manager</a> ‚Üí <span>üìê Êï∞Â≠¶ÂïèÈ°å</span>
        </div>

        <div class="header">
            <h1>üìê Êï∞Â≠¶ÂïèÈ°å</h1>
            <p>„Åô„Åπ„Å¶„ÅÆÊï∞Â≠¶ÂïèÈ°å„ÇíÁµ±‰∏ÄÁÆ°ÁêÜ„Åô„ÇãÂçò‰∏Ä„Ç∑„Çπ„ÉÜ„É†</p>
        </div>

        <div class="stats-bar">
            <h3>Áµ±‰∏ÄÊï∞Â≠¶ÂïèÈ°å„Ç∑„Çπ„ÉÜ„É†</h3>
            <div class="stats-grid">
                <div class="stat-item">
                    <h3 id="totalQuestions">0</h3>
                    <p>Á∑èÂïèÈ°åÊï∞</p>
                </div>
                <div class="stat-item">
                    <h3 id="approvedQuestions">0</h3>
                    <p>ÊâøË™çÊ∏à„Åø</p>
                </div>
                <div class="stat-item">
                    <h3 id="categoriesCount">0</h3>
                    <p>„Ç´„ÉÜ„Ç¥„É™</p>
                </div>
                <div class="stat-item">
                    <h3 id="averageRating">0.0</h3>
                    <p>Âπ≥ÂùáË©ï‰æ°</p>
                </div>
            </div>
        </div>

        <div class="controls-section">
            <div class="controls-grid">
                <div class="control-group">
                    <label for="filterType">ÂïèÈ°åÂΩ¢Âºè</label>
                    <select id="filterType">
                        <option value="">„Åô„Åπ„Å¶</option>
                        <option value="A1">A1Êäû (ÈÅ∏ÊäûÂºè)</option>
                        <option value="F1">F1Ëá™Áî± (Áü≠Á≠îÂºè)</option>
                        <option value="F2">F2Ë®òËø∞ (Ë®òËø∞Âºè)</option>
                    </select>
                </div>
                <div class="control-group">
                    <label for="filterDifficulty">Èõ£ÊòìÂ∫¶</label>
                    <select id="filterDifficulty">
                        <option value="">„Åô„Åπ„Å¶</option>
                        <option value="Êòì">Êòì (Âü∫Á§é)</option>
                        <option value="‰∏≠">‰∏≠ (Ê®ôÊ∫ñ)</option>
                        <option value="Èõ£">Èõ£ (Áô∫Â±ï)</option>
                    </select>
                </div>
                <div class="control-group">
                    <label for="filterCategory">„Ç´„ÉÜ„Ç¥„É™</label>
                    <select id="filterCategory">
                        <option value="">„Åô„Åπ„Å¶</option>
                    </select>
                </div>
                <div class="control-group">
                    <label for="searchText">Ê§úÁ¥¢</label>
                    <input type="text" id="searchText" placeholder="„Çø„Ç§„Éà„É´„ÉªÂïèÈ°åÊñá„ÅßÊ§úÁ¥¢">
                </div>
            </div>
            <div style="display: flex; gap: 10px; flex-wrap: wrap; margin-top: 15px;">
                <button class="btn btn-primary" onclick="applyFilters()">üîç Ê§úÁ¥¢„Éª„Éï„Ç£„É´„ÇøÈÅ©Áî®</button>
                <button class="btn btn-secondary" onclick="clearFilters()">üóëÔ∏è „Éï„Ç£„É´„Çø„ÇØ„É™„Ç¢</button>
                <button class="btn btn-success" onclick="refreshQuestions()">üîÑ Êõ¥Êñ∞</button>
            </div>
        </div>

        <div class="questions-section">
            <div class="questions-header">
                <h2>ÂïèÈ°å‰∏ÄË¶ß</h2>
                <div style="display: flex; gap: 10px; flex-wrap: wrap;">
                    <button class="btn btn-primary" onclick="window.location.href='../creator/'">‚ú® Êñ∞Ë¶è‰ΩúÊàê</button>
                    <button class="btn btn-warning" onclick="sortQuestions()">üìä ‰∏¶„Å≥Êõø„Åà</button>
                </div>
            </div>
            <div class="questions-list" id="questionsList">
                <div class="empty-state">
                    <div class="empty-state-icon">üìù</div>
                    <h3>„Åæ„Å†ÂïèÈ°å„Åå„ÅÇ„Çä„Åæ„Åõ„Çì</h3>
                    <p>„Äå‚ú® Êñ∞Ë¶è‰ΩúÊàê„Äç„Åæ„Åü„ÅØ„Äåüì• „Çµ„É≥„Éó„É´Ë™≠„ÅøËæº„Åø„Äç„ÅßÂïèÈ°å„ÇíËøΩÂä†„Åó„Å¶„Åè„Å†„Åï„ÅÑ</p>
                    <button class="btn btn-primary" onclick="loadSampleData()" style="margin-top: 20px;">üì• „Çµ„É≥„Éó„É´ÂïèÈ°åË™≠„ÅøËæº„Åø</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Áµ±‰∏ÄÊï∞Â≠¶ÂïèÈ°åÁÆ°ÁêÜ„Ç∑„Çπ„ÉÜ„É†
        class UnifiedMathSystem {
            constructor() {
                this.questions = [];
                this.filteredQuestions = [];
                this.sortBy = 'created';
                this.sortOrder = 'desc';
                this.init();
            }

            init() {
                this.loadQuestions();
                this.setupEventListeners();
                this.populateCategoryFilter();
                this.updateStats();
                this.renderQuestions();
            }

            setupEventListeners() {
                // „É™„Ç¢„É´„Çø„Ç§„É†Ê§úÁ¥¢
                document.getElementById('searchText').addEventListener('input', () => {
                    this.applyFilters();
                });

                // „Éï„Ç£„É´„Çø„ÉºÂ§âÊõ¥ÊôÇ„ÅÆËá™ÂãïÈÅ©Áî®
                ['filterType', 'filterDifficulty', 'filterCategory'].forEach(id => {
                    document.getElementById(id).addEventListener('change', () => {
                        this.applyFilters();
                    });
                });
            }

            loadQuestions() {
                this.questions = JSON.parse(localStorage.getItem('mathQuestions') || '[]');
                this.filteredQuestions = [...this.questions];
            }

            populateCategoryFilter() {
                const categories = [...new Set(this.questions.map(q => q.category).filter(Boolean))];
                const categorySelect = document.getElementById('filterCategory');
                
                // Êó¢Â≠ò„Ç™„Éó„Ç∑„Éß„É≥‰ª•Â§ñ„Çí„ÇØ„É™„Ç¢
                categorySelect.innerHTML = '<option value="">„Åô„Åπ„Å¶</option>';
                
                categories.forEach(category => {
                    const option = document.createElement('option');
                    option.value = category;
                    option.textContent = category;
                    categorySelect.appendChild(option);
                });
            }

            updateStats() {
                const total = this.questions.length;
                const approved = this.questions.filter(q => q.approvals >= 3).length;
                const categories = [...new Set(this.questions.map(q => q.category).filter(Boolean))].length;
                const avgRating = total > 0 ? 
                    (this.questions.reduce((sum, q) => sum + (q.rating || 0), 0) / total).toFixed(1) : 
                    0.0;

                document.getElementById('totalQuestions').textContent = total;
                document.getElementById('approvedQuestions').textContent = approved;
                document.getElementById('categoriesCount').textContent = categories;
                document.getElementById('averageRating').textContent = avgRating;
            }

            applyFilters() {
                const typeFilter = document.getElementById('filterType').value;
                const difficultyFilter = document.getElementById('filterDifficulty').value;
                const categoryFilter = document.getElementById('filterCategory').value;
                const searchText = document.getElementById('searchText').value.toLowerCase();

                this.filteredQuestions = this.questions.filter(question => {
                    const matchType = !typeFilter || question.type === typeFilter;
                    const matchDifficulty = !difficultyFilter || question.difficulty === difficultyFilter;
                    const matchCategory = !categoryFilter || question.category === categoryFilter;
                    const matchSearch = !searchText || 
                        question.title.toLowerCase().includes(searchText) ||
                        question.question.toLowerCase().includes(searchText);

                    return matchType && matchDifficulty && matchCategory && matchSearch;
                });

                this.renderQuestions();
            }

            clearFilters() {
                document.getElementById('filterType').value = '';
                document.getElementById('filterDifficulty').value = '';
                document.getElementById('filterCategory').value = '';
                document.getElementById('searchText').value = '';
                this.filteredQuestions = [...this.questions];
                this.renderQuestions();
            }

            sortQuestions() {
                // Á∞°Âçò„Å™‰∏¶„Å≥Êõø„Åà„Éà„Ç∞„É´
                if (this.sortBy === 'created') {
                    this.sortBy = 'title';
                    this.sortOrder = 'asc';
                } else if (this.sortBy === 'title') {
                    this.sortBy = 'rating';
                    this.sortOrder = 'desc';
                } else {
                    this.sortBy = 'created';
                    this.sortOrder = 'desc';
                }

                this.filteredQuestions.sort((a, b) => {
                    let aVal = a[this.sortBy] || '';
                    let bVal = b[this.sortBy] || '';
                    
                    if (this.sortBy === 'created') {
                        aVal = new Date(aVal);
                        bVal = new Date(bVal);
                    }

                    if (this.sortOrder === 'asc') {
                        return aVal > bVal ? 1 : -1;
                    } else {
                        return aVal < bVal ? 1 : -1;
                    }
                });

                this.renderQuestions();
            }

            renderQuestions() {
                const container = document.getElementById('questionsList');
                
                if (this.filteredQuestions.length === 0) {
                    container.innerHTML = `
                        <div class="empty-state">
                            <div class="empty-state-icon">üîç</div>
                            <h3>ÂïèÈ°å„ÅåË¶ã„Å§„Åã„Çä„Åæ„Åõ„Çì</h3>
                            <p>„Éï„Ç£„É´„Çø„ÉºÊù°‰ª∂„ÇíÂ§âÊõ¥„Åô„Çã„Åã„ÄÅÊñ∞„Åó„ÅÑÂïèÈ°å„Çí‰ΩúÊàê„Åó„Å¶„Åè„Å†„Åï„ÅÑ</p>
                        </div>
                    `;
                    return;
                }

                container.innerHTML = this.filteredQuestions.map(question => `
                    <div class="question-card" onclick="viewQuestion('${question.id}')">
                        <div class="question-header">
                            <div class="question-meta">
                                <span>ID: ${question.id}</span>
                                <span>‰ΩúÊàê: ${new Date(question.created).toLocaleDateString()}</span>
                                <span>Ë©ï‰æ°: ‚≠ê${question.rating || 'N/A'}</span>
                            </div>
                        </div>
                        <div class="question-title">${question.title}</div>
                        <div class="question-content">${this.truncateText(question.question, 100)}</div>
                        <div class="question-tags">
                            <span class="tag tag-type">${question.type}</span>
                            <span class="tag tag-difficulty ${question.difficulty === '‰∏≠' ? 'medium' : question.difficulty === 'Èõ£' ? 'hard' : ''}">${question.difficulty}</span>
                            ${question.category ? `<span class="tag tag-category">${question.category}</span>` : ''}
                            <span class="tag tag-approval">ÊâøË™ç${question.approvals || 0}</span>
                        </div>
                    </div>
                `).join('');
            }

            truncateText(text, maxLength) {
                if (text.length <= maxLength) return text;
                return text.substring(0, maxLength) + '...';
            }

            refreshQuestions() {
                this.loadQuestions();
                this.populateCategoryFilter();
                this.updateStats();
                this.applyFilters();
            }
        }

        // „Ç∞„É≠„Éº„Éê„É´Èñ¢Êï∞
        function applyFilters() {
            window.mathSystem.applyFilters();
        }

        function clearFilters() {
            window.mathSystem.clearFilters();
        }

        function refreshQuestions() {
            window.mathSystem.refreshQuestions();
        }

        function sortQuestions() {
            window.mathSystem.sortQuestions();
        }

        function viewQuestion(questionId) {
            // ÂïèÈ°åË©≥Á¥∞Ë°®Á§∫Ôºà‰ªäÂæåÂÆüË£ÖÔºâ
            alert(`ÂïèÈ°å ${questionId} „ÅÆË©≥Á¥∞Ë°®Á§∫Ê©üËÉΩ„ÅØ‰ªäÂæåÂÆüË£Ö‰∫àÂÆö„Åß„Åô`);
        }

        function loadSampleData() {
            // Áµ±‰∏Ä„Çµ„É≥„Éó„É´„Éá„Éº„Çø
            const sampleData = [
                {
                    id: 'math_001',
                    type: 'A1',
                    title: '‰∫åÊ¨°ÊñπÁ®ãÂºè„ÅÆËß£',
                    question: 'x¬≤ - 5x + 6 = 0 „ÅÆËß£„ÅØÔºü',
                    choices: ['x = 1, 6', 'x = 2, 3', 'x = -2, -3', 'x = -1, -6'],
                    correct: 1,
                    difficulty: '‰∏≠',
                    category: '‰ª£Êï∞',
                    explanation: 'Âõ†Êï∞ÂàÜËß£„Åô„Çã„Å® (x-2)(x-3) = 0 „Çà„Çä x = 2, 3',
                    created: new Date().toISOString(),
                    approvals: 3,
                    rating: 4.2
                },
                {
                    id: 'math_002',
                    type: 'F1',
                    title: '‰∏âËßíÈñ¢Êï∞„ÅÆÂÄ§',
                    question: 'sin 60¬∞ „ÅÆÂÄ§„ÇíÊ±Ç„ÇÅ„Å™„Åï„ÅÑ„ÄÇ',
                    answer: '‚àö3/2',
                    difficulty: 'Êòì',
                    category: '‰∏âËßíÈñ¢Êï∞',
                    explanation: 'ÁâπÂà•Ëßí„ÅÆÂÄ§„Å®„Åó„Å¶Ë¶ö„Åà„ÇãÂü∫Êú¨ÂÄ§',
                    created: new Date().toISOString(),
                    approvals: 4,
                    rating: 4.0
                },
                {
                    id: 'math_003',
                    type: 'F2',
                    title: 'Ê•µÈôê„ÅÆË®àÁÆó',
                    question: 'lim(x‚Üí0) sin x / x „ÇíÊ±Ç„ÇÅ„Çà„ÄÇ',
                    answer: '1',
                    difficulty: 'Èõ£',
                    category: 'ÂæÆÂàÜ',
                    explanation: '„É≠„Éî„Çø„É´„ÅÆÂÆöÁêÜ„Çí‰ΩøÁî®„Åô„Çã„Åã„ÄÅÊ®ôÊ∫ñÁöÑ„Å™Ê•µÈôê„Å®„Åó„Å¶Áü•„Çâ„Çå„Å¶„ÅÑ„ÇãÂÄ§',
                    created: new Date().toISOString(),
                    approvals: 5,
                    rating: 3.8
                },
                {
                    id: 'math_004',
                    type: 'A1',
                    title: 'Á¢∫Áéá„ÅÆÂü∫Êú¨',
                    question: '„Ç≥„Ç§„É≥„Çí3ÂõûÊäï„Åí„Å¶„ÄÅ„Åô„Åπ„Å¶Ë°®„ÅåÂá∫„ÇãÁ¢∫Áéá„ÅØÔºü',
                    choices: ['1/2', '1/4', '1/8', '1/16'],
                    correct: 2,
                    difficulty: 'Êòì',
                    category: 'Á¢∫Áéá',
                    explanation: '(1/2)¬≥ = 1/8',
                    created: new Date().toISOString(),
                    approvals: 3,
                    rating: 4.5
                },
                {
                    id: 'math_005',
                    type: 'F1',
                    title: 'ÂæÆÂàÜ„ÅÆË®àÁÆó',
                    question: 'f(x) = x¬≥ + 2x¬≤ - x + 1 „ÅÆÂ∞éÈñ¢Êï∞„ÇíÊ±Ç„ÇÅ„Å™„Åï„ÅÑ„ÄÇ',
                    answer: 'f\'(x) = 3x¬≤ + 4x - 1',
                    difficulty: '‰∏≠',
                    category: 'ÂæÆÂàÜ',
                    explanation: 'ÂêÑÈ†Ö„Çí„Åπ„Åç‰πó„ÅÆÂÖ¨Âºè„ÅßÂæÆÂàÜ„Åô„Çã',
                    created: new Date().toISOString(),
                    approvals: 4,
                    rating: 4.1
                }
            ];

            localStorage.setItem('mathQuestions', JSON.stringify(sampleData));
            window.mathSystem.refreshQuestions();
            alert('‚úÖ „Çµ„É≥„Éó„É´ÂïèÈ°å„Çí5ÂïèË™≠„ÅøËæº„Åø„Åæ„Åó„ÅüÔºÅ');
        }

        // „Ç∑„Çπ„ÉÜ„É†ÂàùÊúüÂåñ
        document.addEventListener('DOMContentLoaded', () => {
            window.mathSystem = new UnifiedMathSystem();
        });
    </script>
</body>
</html>